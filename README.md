# 吉利汽车签到脚本 - Node.js版本

这是一个适用于Node.js环境的吉利汽车自动签到脚本，从原始的Quantumult-X脚本改编而来。

## 功能特性

- ✅ 自动签到
- ✅ 获取累计签到天数
- ✅ 查询能量体余额
- ✅ 完善的错误处理
- ✅ 详细的日志输出

## 环境要求

- Node.js 14.0+ 
- npm

## 安装和配置

1. **安装依赖**
   ```bash
   npm install
   ```

2. **获取配置信息**
   - 手机安装吉利汽车APP
   - 使用抓包工具（Charles、Fiddler、Quantumult X等）
   - 在APP中进行任意操作，抓取请求头中的`token`和`devicesn`字段

3. **设置环境变量**
   
   方法一：直接设置环境变量
   ```bash
   export geely_val='{"token":"your_token_here","devicesn":"your_devicesn_here"}'
   ```
   
   方法二：创建.env文件（推荐）
   ```bash
   cp .env.example .env
   # 编辑.env文件，填入真实的token和devicesn值
   ```

## 使用方法

```bash
# 方法一：使用npm脚本
npm start

# 方法二：使用自定义脚本
npm run geely

# 方法三：直接运行
node geely-node.js
```

## 输出示例

```
[2025-08-23 10:30:00] ✅ 配置加载成功
[2025-08-23 10:30:01] 🚀 开始执行 吉利汽车签到
[2025-08-23 10:30:02] 最新版本号：3.28.0
[2025-08-23 10:30:03] 签到：签到成功
[2025-08-23 10:30:04] 累计签到：15天
[2025-08-23 10:30:05] 能量体：12.5
[2025-08-23 10:30:06] ✅ 吉利汽车签到 执行完成
[2025-08-23 10:30:07] 📋 执行结果:
签到：签到成功
累计签到：15天
能量体：12.5
```

## 文件说明

- `geely-node.js` - Node.js版本主脚本
- `geely.js` - 原始Quantumult-X版本（保留）
- `.env.example` - 环境变量配置示例
- `package.json` - 项目配置和依赖

## 注意事项

1. **安全性**：请妥善保管你的token和devicesn，不要泄露给他人
2. **频率**：建议每天运行一次，避免频繁请求被风控
3. **更新**：如果App版本更新导致签到失败，可能需要重新获取配置信息

## 定时任务设置

### 使用cron定时执行（Linux/Mac）
```bash
# 编辑crontab
crontab -e

# 添加定时任务（每天早上9点执行）
0 9 * * * cd /path/to/your/project && /usr/bin/node geely-node.js >> /var/log/geely.log 2>&1
```

### 使用Windows任务计划程序
1. 打开"任务计划程序"
2. 创建基本任务
3. 设置触发器（每天）
4. 设置操作：启动程序 `node`，参数：脚本完整路径

## 故障排除

**Q: 提示"请设置环境变量 geely_val"**  
A: 确保正确设置了环境变量，格式必须是有效的JSON字符串

**Q: 提示"Token错误"**  
A: token已过期或无效，需要重新抓取

**Q: 签到失败**  
A: 可能是网络问题或App接口变更，检查网络连接和脚本版本

## 更新日志

- 2025-08-23: 创建Node.js版本，移除Quantumult-X依赖
- 改进错误处理和日志输出
- 优化设备信息和签名算法
- 添加完整的使用文档